# ローカル環境リセット

Prisma接続エラーやキャッシュの問題を解決するためのローカル環境リセットスクリプトです。

## 使用方法

### 1. 自動リセット＆セットアップ（推奨）
```bash
npm run reset:auto
```
- Prismaクライアントの再生成
- キャッシュクリア
- 依存関係の再インストール
- 開発サーバーの自動起動
- サーバー起動後にマスタデータを自動セットアップ

### 2. 完全リセット
```bash
npm run reset:full
```
- Prismaクライアントの再生成
- キャッシュクリア
- 依存関係の再インストール
- 開発サーバーの自動起動
- マスタデータは手動でセットアップ

### 3. リセットのみ
```bash
npm run reset
```
- リセット処理のみ実行
- サーバーは手動で起動する必要があります

### 4. クイックリセット
```bash
npm run quick-reset
```
- 基本的なリセット処理
- 高速実行
- 開発サーバーの自動起動

### 5. シェルスクリプト直接実行
```bash
./scripts/quick-reset.sh
```

## 実行される処理

1. **プロセス停止**
   - `npm run dev` や `npm start` のプロセスを停止

2. **Prismaクライアント再生成**
   - `npx prisma generate` を実行

3. **キャッシュクリア**
   - `.next` ディレクトリを削除
   - `node_modules/.cache` ディレクトリを削除

4. **依存関係再インストール**（完全リセットのみ）
   - `npm install` を実行

5. **マスタデータセットアップ**（完全リセットのみ）
   - `/api/setup-master-data` を呼び出し

6. **開発サーバー起動**（完全リセット・クイックリセット）
   - `npm run dev` を実行

## トラブルシューティング

### 権限エラー
```bash
chmod +x scripts/quick-reset.sh
```

### プロセスが停止しない
```bash
# 手動でプロセスを停止
pkill -f "next dev"
pkill -f "next start"
```

### マスタデータエラー
```bash
# 手動でマスタデータをセットアップ
curl -X POST http://localhost:3000/api/setup-master-data
```

## 注意事項

- リセット中はアプリケーションが一時的に停止します
- 完全リセットは時間がかかります（依存関係の再インストールのため）
- クイックリセットは高速ですが、依存関係の問題は解決されません 